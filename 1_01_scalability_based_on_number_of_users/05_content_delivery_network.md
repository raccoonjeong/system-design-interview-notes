CDN은 정적 콘텐츠를 전송하는 데 쓰이는, 지리적으로 분산된 서버의 네트워크
이미지, 비디오, CSS, JS파일 등을 캐시할 수 있음

- 동적 콘텐츠 캐싱
  - request path, query string, cookie, request header 등의 정보에 기반하여 HTML 페이지를 캐시하는 것
  - 정적 콘텐츠 캐싱과 다름

- CDN 동작 순서
  1. 사용자 A가 이미지 URL을 이용해 image.png에 접근함. 해당 도메인은 CDN 서비스 사업자가 제공
  2. CDN 서비스의 캐시에 해당 이미지가 없는 경우, 서버는 원본 서버에 요청하여 파일을 가져옴. 원본 서버는 웹 서버일 수도 있고 아마존 S3같은 온라인 저장소일 수도 있음.
  3. 원본 서버가 파일을 CDN 서버에 반환함. 응답의 HTTP 헤더에는 해당 파일이 얼마나 오래 캐시될 수 있는지를 설명하는 TTL(Time-To-Live) 값이 들어 있다.
  4. CDN 서버는 파일을 캐시하고 사용자 A에게 반환함. 이미지는 TTL에 명시된 시간동안만 캐시됨
  5. 사용자 B가 같은 이미지에 대한 요청을 CDN 서버에 전송
  6. 만료되지 않은 이미지에 대한 요청은 캐시를 통해 처리

- CDN 사용 시 고려해야 할 사항
  - 비용: CDN에 들어가고 나가는 데이터 전송 양에 따라 요금이 부과됨. 자주 사용되지 않는 콘텐츠는 빼는 것을 고려하도록 하자.
  - 적절한 만료 시한 설정: 시의성이 중요한(time-sensitive) 콘텐츠의 경우 만료 시점을 잘 정해야 함.
  - 장애 대처 방안: CDN 자체가 죽었을 경우 웹사이트/애플리케이션이 어떻게 동작해야하는지 고려해야 함. 응답이 없을 때, 원본 서버로부터 직접 가져오도록 클라이언트를 구성하는 것이 필요할 수도 있다.
  - 콘텐츠 무효화(invalidation) 방법: 아직 만료되지 않아도 CDN에서 제거 가능
    - CDN 서비스 사업자가 제공하는 API 이용
    - 콘텐츠의 다른 버전을 서비스하도록 오브젝트 버저닝 이용. ex) image.png?v=2
