## 메시지 큐

시스템의 컴포넌트를 분리하여, 각기 독립적으로 확장될 수 있도록 채용하는 핵심적 전략

- 메시지 큐의 특징
  - 메시지의 무손실(durability, 즉 메시지 큐에 일단 보관된 메시지는 소비자가 꺼낼 때까지 안전히 보관된다는 특성)을 보장
  - 메시지의 버퍼 역할
  - 비동기적으로 전송

- 메시지 큐의 기본 아키텍쳐
  1. 생산자 또는 발행자(producer/publisher)라고 불리는 입력 서비스가 메시지를 만들어 메시지 큐에 발행(publish)
  2. 큐에는 보통 소비자 혹은 구독자(consumer/subscriber)라 불리는 서비스 혹은 서버가 연결되어 있음
  3. 서비스 혹은 서버는 메시지를 받아 그에 맞는 동작을 수행함

- 메시지 큐의 장점
  - 서비스 또는 서버 간 결합이 느슨해져서, 규모 확장에 좋다.
  - 생산자는 소비자 프로세스가 다운되어도 메시지 발행 가능
  - 소비자는 생산자 서비스가 다운되어도 메시지 수신 가능

- 메시지 큐의 사용 예시
  - 사진 보정 애플리케이션
    1. 여러 보정 작업을 메시지 큐에 넣는다.
    2. 보정 작업(worker) 프로세스들은 이 작업을 메시지 큐에서 꺼내어 비동기적으로 완료함
    - 특징
      - 생산자와 소비자 서비스의 규모는 독립적으로 확장 가능
      - 큐의 크기가 커지면 더 많은 작업 프로세스를 추가해야 처리 시간을 줄일 수 있음
      - 큐가 거의 항상 비어 있는 상태라면, 작업 프로세스의 수를 줄일 수 있음

메시지 큐는 각 컴포넌트가 보다 느슨히 결합(loosely coupled)될 수 있도록 하고, 결함에 대한 내성을 높인다.
