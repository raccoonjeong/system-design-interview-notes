## 데이터베이스의 규모 확장

데이터베이스의 규모를 확장하는 두 가지 접근법

1. 수직적 규모 확장법
2. 수평적 규모 확장법

### 수직적 확장

- 스케일 업이라고도 부름
- 기존 서버에 더 많은, 또는 고성능의 자원(CPU, RAM, 디스크 등)을 증설하는 방법
- 단점
  - 하드웨어를 무한으로 증설할 수는 없으며 서버 한 대로는 결국 한계가 온다
  - SPOF(Single Point of Failure)로 인한 위험이 큼
  - 비용이 많이 든다

### 수평적 확장

- 샤딩(sharding) - 데이터베이스의 수평적 확장
  - 대규모 데이터베이스를 샤드(shard)라는 작은 단위로 분할
  - 모든 샤드는 같은 스키마를 쓰지만 샤드에 보관된 데이터 사이에는 중복이 없음
  - 샤딩 키(파티션 키)가 중요
    - 데이터를 어떻게 분산할지 정하는 하나 이상의 칼럼으로 구성
  - 단점
    - 데이터의 재 샤딩(resharding)
      1. 데이터가 너무 많아져서 하나의 샤드로 더 이상 감당하기 어려울 때
      2. 샤드 간 데이터 분포가 균등하지 못해서 어떤 샤드는 공간을 빠르게 소모할 때(샤드 소진, shard exhaustion)
         -> 샤드 키를 계산하는 함수를 변경하고 데이터를 재배치 해야함. 안정 해시(consistent hashing) 기법을 활용하면 문제 해결 가능.
    - 유명인사(celebrity) 문제 (핫스팟 키 문제)
      - 특정 샤드에 질의가 집중되어 서버에 과부하 걸리는 문제
    - 조인과 비정규화(join and de-normalization)
      - 하나의 DB를 여러 샤드 서버로 쪼개고 나면, 여러 샤드에 걸친 데이터를 조인하기 힘들어진다. 이를 해결하는 한가지 방법은 DB를 비정규화하여 하나의 테이블에서 질의가 수행될 수 있도록 하는 것
